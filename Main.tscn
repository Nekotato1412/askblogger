[gd_scene load_steps=11 format=2]

[ext_resource path="res://components/dialog_box/DialogBox.tscn" type="PackedScene" id=1]
[ext_resource path="res://components/size_screen/SizeScreen.tscn" type="PackedScene" id=2]
[ext_resource path="res://assets/fonts/root_font.tres" type="DynamicFont" id=3]
[ext_resource path="res://Main.gd" type="Script" id=6]
[ext_resource path="res://generic_scripts/GenericChangeTexture.gd" type="Script" id=8]
[ext_resource path="res://generic_scripts/ImageChangeButton.gd" type="Script" id=9]
[ext_resource path="res://components/portrait/Portrait.tscn" type="PackedScene" id=10]
[ext_resource path="res://assets/images/default_background.jpg" type="Texture" id=13]

[sub_resource type="GDScript" id=10]
resource_name = "AutoHide"
script/source = "extends CanvasLayer


func _on_Main_presentation_mode():
	hide()


func _on_Main_edit_mode():
	show()


func _on_Main_setup_mode():
	hide()
"

[sub_resource type="GDScript" id=11]
resource_name = "FontSize"
script/source = "extends LineEdit
signal font_size_changed


onready var old_text = text


func _on_FontSize_text_entered(new_text):
	if (int(new_text) == 0):
		text = old_text
		return

	old_text = new_text
	var new_size = clamp(int(new_text), 10, 24)
	text = str(new_size)
	
	emit_signal(\"font_size_changed\", new_size)
"

[node name="Main" type="Control"]
anchor_right = 1.0
anchor_bottom = 1.0
mouse_filter = 2
script = ExtResource( 6 )

[node name="BackgroundLayer" type="CanvasLayer" parent="."]
layer = -1

[node name="Background" type="TextureRect" parent="BackgroundLayer"]
anchor_right = 1.0
anchor_bottom = 1.0
texture = ExtResource( 13 )
expand = true
stretch_mode = 1
script = ExtResource( 8 )

[node name="PortraitLayer" type="CanvasLayer" parent="."]
layer = 0

[node name="Portrait" parent="PortraitLayer" instance=ExtResource( 10 )]

[node name="DialogLayer" type="CanvasLayer" parent="."]

[node name="DialogBox" parent="DialogLayer" instance=ExtResource( 1 )]

[node name="UILayer" type="CanvasLayer" parent="."]
layer = 10
script = SubResource( 10 )

[node name="PresentationMode" type="Button" parent="UILayer"]
margin_right = 133.0
margin_bottom = 20.0
custom_fonts/font = ExtResource( 3 )
text = "Save"

[node name="PortraitChange" type="Button" parent="UILayer"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -51.0
margin_top = -10.0
margin_right = 51.0
margin_bottom = 10.0
custom_fonts/font = ExtResource( 3 )
text = "Change Image"
script = ExtResource( 9 )
identifier = "portrait"

[node name="BackgroundChange" type="Button" parent="UILayer"]
anchor_left = 1.0
anchor_right = 1.0
margin_left = -251.0
margin_top = 103.0
margin_right = -87.0
margin_bottom = 132.0
custom_fonts/font = ExtResource( 3 )
text = "Change Background"
script = ExtResource( 9 )
identifier = "background"

[node name="DialogChange" type="Button" parent="UILayer"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -58.0
margin_top = 73.0
margin_right = 75.0
margin_bottom = 102.0
custom_fonts/font = ExtResource( 3 )
text = "Change Textbox"
script = ExtResource( 9 )
identifier = "dialog"

[node name="SetupMode" type="Button" parent="UILayer"]
anchor_left = 1.0
anchor_right = 1.0
margin_left = -82.0
margin_top = 25.0
margin_right = -26.0
margin_bottom = 54.0
custom_fonts/font = ExtResource( 3 )
text = "Setup"

[node name="FontChange" type="Button" parent="UILayer"]
anchor_left = 0.5
anchor_right = 0.5
margin_left = -45.0
margin_right = 45.0
margin_bottom = 20.0
custom_fonts/font = ExtResource( 3 )
text = "Change Font"

[node name="FileName" type="LineEdit" parent="UILayer"]
anchor_top = 0.5
anchor_bottom = 0.5
margin_left = 2.0
margin_top = -161.0
margin_right = 134.0
margin_bottom = -128.0
custom_fonts/font = ExtResource( 3 )
text = "blog"
align = 1
max_length = 10

[node name="FontSize" type="LineEdit" parent="UILayer"]
anchor_left = 0.5
anchor_right = 0.5
margin_left = 3.0
margin_top = 50.0
margin_right = 61.0
margin_bottom = 83.0
custom_fonts/font = ExtResource( 3 )
align = 1
placeholder_text = "16"
script = SubResource( 11 )

[node name="Label" type="Label" parent="UILayer"]
anchor_left = 0.5
anchor_right = 0.5
margin_left = -44.0
margin_top = 54.0
margin_right = -4.0
margin_bottom = 77.0
custom_fonts/font = ExtResource( 3 )
text = "Size"
align = 1
valign = 1

[node name="Super" type="CanvasLayer" parent="."]
layer = 100

[node name="ImageDialog" type="FileDialog" parent="Super"]
anchor_right = 1.0
anchor_bottom = 1.0
window_title = "Open a File"
resizable = true
dialog_text = "Choose an image"
dialog_hide_on_ok = true
mode = 0
access = 2
filters = PoolStringArray( "*.png ; Portable Network Graphics", "*.jpg ; Lossy Compression", "*.jpeg ; Lossy Compression", "*.webp ; WebP", "*.tga ; Truevision Targa", "*.bmp ; Bitmap Image" )

[node name="FontDialog" type="FileDialog" parent="Super"]
anchor_right = 1.0
anchor_bottom = 1.0
window_title = "Open a File"
resizable = true
dialog_text = "Choose a font."
dialog_hide_on_ok = true
mode = 0
access = 2
filters = PoolStringArray( "*.ttf ; TrueType Font" )

[node name="SizeDropdown" parent="Super" instance=ExtResource( 2 )]
visible = false

[connection signal="edit_mode" from="." to="PortraitLayer/Portrait" method="_on_Main_edit_mode"]
[connection signal="edit_mode" from="." to="DialogLayer/DialogBox" method="_on_Main_edit_mode"]
[connection signal="edit_mode" from="." to="UILayer" method="_on_Main_edit_mode"]
[connection signal="font_change" from="." to="DialogLayer/DialogBox" method="_on_Main_font_change"]
[connection signal="font_size_change" from="." to="DialogLayer/DialogBox" method="_on_Main_font_size_change"]
[connection signal="presentation_mode" from="." to="PortraitLayer/Portrait" method="_on_Main_presentation_mode"]
[connection signal="presentation_mode" from="." to="DialogLayer/DialogBox" method="_on_Main_presentation_mode"]
[connection signal="presentation_mode" from="." to="UILayer" method="_on_Main_presentation_mode"]
[connection signal="setup_mode" from="." to="PortraitLayer/Portrait" method="_on_Main_setup_mode"]
[connection signal="setup_mode" from="." to="DialogLayer/DialogBox" method="_on_Main_setup_mode"]
[connection signal="setup_mode" from="." to="UILayer" method="_on_Main_setup_mode"]
[connection signal="button_up" from="UILayer/PresentationMode" to="." method="_on_PresentationMode_button_up"]
[connection signal="button_up" from="UILayer/SetupMode" to="." method="_on_SetupMode_button_up"]
[connection signal="button_up" from="UILayer/FontChange" to="." method="_on_FontChange_button_up"]
[connection signal="text_changed" from="UILayer/FileName" to="." method="_on_FileName_text_changed"]
[connection signal="font_size_changed" from="UILayer/FontSize" to="." method="_on_FontSize_font_size_changed"]
[connection signal="text_entered" from="UILayer/FontSize" to="UILayer/FontSize" method="_on_FontSize_text_entered"]
[connection signal="file_selected" from="Super/ImageDialog" to="." method="_on_image_selected"]
[connection signal="file_selected" from="Super/FontDialog" to="." method="_on_font_selected"]
